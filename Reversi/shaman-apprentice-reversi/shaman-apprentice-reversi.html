<link rel="import" href="data-model.html" />

<script>
  (function() {
    function buildTemplate() {
      const template = document.createElement("template")
      template.content.appendChild(shamanApprenticeReversiNs.tmp.buildBoardCss())

      const board = document.createElement("div");
      board.setAttribute("class", "board")

      function handleStartFormation(y, x) {
        if (shamanApprenticeReversiNs.board[y][x] === 1) {
          return "black"
        }
        if (shamanApprenticeReversiNs.board[y][x] === -1) {
          return "white"
        }
        return ""
      }

      for (let y = 0; y <= 7; y++) {
        for (let x = 0; x <= 7; x++) {
          board.innerHTML += `
            <div
              class="field ${handleStartFormation(y, x)}"
              data-y="${y}"
              data-x="${x}"
              onclick="shamanApprenticeReversiNs.handleFieldClick(event, ${y}, ${x})"
            >
              <div class="stone"></div>
              <div class="square-hack"></div>
            </div>
          `
        }
      }

      template.content.appendChild(board)
      return template
    }

    const template = buildTemplate()

    window.customElements.define("shaman-apprentice-reversi", class extends HTMLElement {
      constructor() {
        super()
        const shadowRoot = this.attachShadow({mode: "open"})
        shadowRoot.appendChild(template.content.cloneNode(true))
      }
    })
  })()
</script>